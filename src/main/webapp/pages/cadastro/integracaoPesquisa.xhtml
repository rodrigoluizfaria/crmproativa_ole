<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://java.sun.com/jsf/html"
             xmlns:f="http://java.sun.com/jsf/core"
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:matriz="http://java.sun.com/jsf/composite/componentes"
             xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">

    <p:growl id="grl"/>

    <h:form id="pesqIntegracao" prependId="false">


        <div class="card ">

            <div class="ui-fluid formgrid grid">

                <matriz:selectEmpresa id="cmbEmpresa" style="col-12 md:col-3" managedBean="#{integracaoBean}"
                                      value="#{integracaoBean.integracao.empresa}" filter="true"/>


                <div class="field col-12 md:col-3">

                    <p:outputLabel for="inputDesc" value="Descrição"/>

                    <p:inputText id="inputDesc" value="#{integracaoBean.integracao.descricao}"/>

                </div>

                <div class="field col-12 md:col-3">

                    <p:outputLabel for="selectOneTipo" value="Tipo:"/>

                    <p:selectOneMenu id="selectOneTipo" value="#{integracaoBean.integracao.tipoIntegracao}"
                                     filter="true" filterMatchMode="contains">

                        <f:selectItem itemLabel="Selecione" noSelectionOption="true"/>

                        <f:selectItems value="#{integracaoBean.tipoIntegracao}" var="tipo" itemLabel="#{tipo.constante}"
                                       itemValue="#{tipo}"/>

                    </p:selectOneMenu>

                </div>

                <div class="field col-12 md:col-3">

                    <p:outputLabel for="selectOneAtivo" value="Acesso:"/>

                    <p:selectOneMenu id="selectOneAtivo" value="#{integracaoBean.integracao.ativo}">

                        <f:selectItem itemLabel="Selecione" noSelectionOption="true"/>

                        <f:selectItems value="#{integracaoBean.tipoAcessoEnum}" var="acesso"
                                       itemLabel="#{acesso.constante}" itemValue="#{acesso}"/>

                    </p:selectOneMenu>

                </div>
            </div>

            <div class="mt-5">

                <p:commandButton value="Pesquisar" styleClass="mr-3 ui-button-raised" id="btnPesquisar"
                                 action="#{integracaoBean.pesquisar()}" update="@form" icon="pi pi-search"/>


                <p:commandButton id="btnExportar" icon="pi pi-file-excel" value="#{msg.exportar}" ajax="false"
                                 styleClass="mr-3 ui-button-outlined ui-button-raised"
                                 rendered="#{sessionScope['usuario'].permissaoExportar}"
                                 disabled="#{empty integracaoBean.listIntegracao}"
                                 immediate="true">

                    <p:dataExporter target="tableIntegracao" type="xls" fileName="integracao"/>

                </p:commandButton>

                <p:commandButton value="Novo" id="btnNovo" styleClass="ui-button-outlined ui-button-raised"
                                 actionListener="#{integracaoBean.novo()}" ajax="false" icon="pi pi-plus-circle"
                                 immediate="true"/>
            </div>


        </div>

        <div class="mt-4">

            <div class="card">

                <p:dataTable id="tableIntegracao"
                             value="#{integracaoBean.listIntegracao}" var="integracao"
                             rows="15" paginator="true" paginatorPosition="bottom"
                             emptyMessage="#{msg.emptyMessage}"
                             styleClass="ui-datatable-striped ui-datatable-gridlines ui-datatable-sm"
                             currentPageReportTemplate="[#{msg.totalDeRegistros}: {totalRecords}]"
                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">


                    <p:column headerText="Empresa" sortBy="#{integracao.empresa.nome}"
                              width="15%" sortable="#{integracao.empresa.nome}">

                        <h:outputText value="#{integracao.empresa.nome}"/>

                    </p:column>

                    <p:column headerText="Descrição" sortBy="#{integracao.descricao}"
                              width="15%">

                        <h:outputText value="#{integracao.descricao}"/>

                    </p:column>

                    <p:column headerText="Url" width="40%" sortBy="#{integracao.url}">

                        <h:outputText value="#{integracao.url}"/>

                    </p:column>

                    <p:column headerText="Tipo" width="20%" sortBy="#{integracao.tipoIntegracao.constante}">

                        <h:outputText value="#{integracao.tipoIntegracao.constante}"/>

                    </p:column>

                    <p:column headerText="Acesso" width="10%" sortBy="#{integracao.ativo.constante}">

                        <h:outputText value="#{integracao.ativo.constante}"/>

                    </p:column>

                    <p:column headerText="Ação" width="5%" exportable="false">

                        <p:commandButton icon="fa fw fa-edit" styleClass="rounded-button ui-button-flat"
                                         action="#{integracaoBean.editar(integracao)}" ajax="false">

                            <f:setPropertyActionListener value="#{integracao}" target="#{integracaoBean.integracao}"/>

                        </p:commandButton>

                    </p:column>

                </p:dataTable>

            </div>

        </div>

    </h:form>


</ui:fragment>
