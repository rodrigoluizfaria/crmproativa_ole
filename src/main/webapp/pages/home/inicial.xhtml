<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:of="http://omnifaces.org/functions"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<ui:param name="viewname" value="HOME" />

	<ui:define name="content">

		<div class="ui-fluid">

			<p:growl id="grl" widgetVar="grl" globalOnly="true" escape="false"	showSummary="false" life="8000" showDetail="true" sticky="false">

				<p:autoUpdate />

			</p:growl>

			<c:if test="#{sistemaBean.scriptVonix}">

				<h:outputScript name="js/vonix-1.6.min.js" />
				<h:outputScript target="head" library="js"	name="vonix-integra.js?v23" />

				<h:form id="formVonix" prependId="false">

						<script>
								
								var servidor = "#{sistemaBean.usuario.pontoAtendimento.pabx.url}";
								var login = "#{sistemaBean.usuario.pontoAtendimento.ramal}";
								var pausa = "#{sessionScope['usuario'].pausaVonix}"
								iniciarIntegraVonixPausa(servidor,login,pausa);
										
						</script>

				</h:form>
				
			</c:if>

			<h:form id="conteudo" prependId="false">

				<p:remoteCommand id="remoteVonix" name="remoteVonix" actionListener="#{sistemaBean.iniciarPausaVonix()}">

				</p:remoteCommand>

				<h:panelGroup layout="block" rendered="#{inicialBean.controlePausa eq null and inicialBean.usuario.perfil ne 'USUARIO_CONSULTA'}">

					<ui:include src="/pages/dashboard/dashProjecaoFragmento.xhtml" />

				</h:panelGroup>


				<h:panelGroup id="painelPausa" layout="block"	rendered="#{empty requestScope['javax.servlet.error.message'] and inicialBean.controlePausa ne null}"	styleClass="flex justify-content-center flex-wrap">

					<p:poll interval="5" listener="#{inicialBean.onRefreshPausa()}"	update="panelP" global="false" />

					<div class="col-6" style="padding: 0px">

						<div class="div-pausa-content" style="">

							<div class=" card border-left-3 border-primary-300 " style="display: flex; align-items: center; padding: 15px">

								<!-- 			<i class="fa fa-pause-circle-o" style="font-size: 7rem" /> -->
								<p:graphicImage styleClass="mr-5 ml-2" name="img/pausa.png"	style="float: right;opacity: 0.4;filter: alpha(opacity=40);width: 64px; " />

								<h1>PAUSA #{inicialBean.controlePausa.pausa.descricao}</h1>
								
							</div>
							
							<div style="padding: 20px; " class="font-p mt-1 mb-3 card border-left-3 border-primary-300">

								<div style="position: relative; margin-left: auto; margin-right: auto;" class="col-12">
								
									<p style="margin-bottom: 5px;" class="font-p">

										<strong>Entrada:</strong>
										#{of:formatDate(inicialBean.controlePausa.dataCadastro,'dd/MM/yyyy
										HH:mm:ss')}

									</p>

									<p style="margin-bottom: 5px;" class="font-p">

										<strong> Retorno:</strong>
										#{inicialBean.controlePausa.pausa.tempo eq null? 'tempo de
										retorno não definido.' :
										of:formatDate(of:addMinutes(inicialBean.controlePausa.dataCadastro,inicialBean.controlePausa.pausa.tempo),'dd/MM/yyyy
										HH:mm:ss')}

									</p>

									<h:panelGroup style="font-weight: bold;" id="panelP" styleClass="font-p"> Entrou em pausa:  #{inicialBean.tempoPausa}</h:panelGroup>

									<!-- <pe:timeAgo value="#{inicialBean.controlePausa.dataCadastro}" titlePattern="dd MMMM yyyy HH:mm:ss" style="font-weight:bold;font-size:16px" locale="pt" /> -->
								</div>

								<div class="col-12 div-pausa-footer mt-6" style="padding: 15px; text-align: center">

									<p:commandButton styleClass="ui-button-raised " value="Retornar" actionListener="#{inicialBean.removerPausa()}" style="width: 200px" ajax="false" update="@form" />

								</div>


							</div>


						</div>

					</div>

				</h:panelGroup>

				<script>
					
						PrimeFacesExt.locales.TimeAgo['pt'] = {
							prefixAgo : "há",
							prefixFromNow : "em",
							suffixAgo : null,
							suffixFromNow : null,
							seconds : "alguns segundos",
							minute : "um minuto",
							minutes : "%d minutos",
							hour : "uma hora",
							hours : "%d horas",
							day : "um dia",
							days : "%d dias",
							month : "um mês",
							months : "%d meses",
							year : "um ano",
							years : "%d anos"
						}
						
					</script>

			</h:form>

		</div>

	</ui:define>

</ui:composition>