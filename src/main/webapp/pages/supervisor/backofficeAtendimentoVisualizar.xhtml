<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://java.sun.com/jsf/html"
             xmlns:f="http://java.sun.com/jsf/core"
             xmlns:p="http://primefaces.org/ui"
             xmlns:c="http://java.sun.com/jsp/jstl/core"
             xmlns:of="http://omnifaces.org/functions"
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:cc="http://java.sun.com/jsf/composite/componentes">

    <style>
        /* CORREÇÃO: Aplica o Flexbox APENAS quando o dialog estiver visível (aria-hidden="false") */
        /* Isso impede que ele abra sozinho ao carregar a página */
        body .dlg-flex-fix.ui-dialog[aria-hidden="false"] {
            display: flex !important;
            flex-direction: column !important;
            height: 90vh !important;
            top: 5vh !important;
            max-height: 100vh !important;
        }

        /* Garante que o conteúdo ocupe o espaço restante */
        body .dlg-flex-fix .ui-dialog-content {
            flex: 1 1 auto !important;
            width: 100% !important;
            padding: 0 !important;
            overflow: hidden !important;
            position: relative;
            display: flex !important;
            flex-direction: column !important;
        }

        /* Scrollbars e Tabs */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        body .clean-tabs .ui-tabs-nav {
            background: transparent;
            border: none;
            border-bottom: 1px solid #e5e7eb;
        }

        body .clean-tabs .ui-tabs-panel {
            padding: 0 !important;
        }

        .rounded-button.ui-button {
            border-radius: 2rem;
            width: 2.5rem;
            height: 2.5rem;
            padding: 0;
        }

        .rounded-button.ui-button .ui-button-icon-left {
            margin: 0;
        }
    </style>

    <p:dialog id="dlgVisualizarAtendimento" widgetVar="dlgVisualizarAtendimento"
              modal="true" draggable="false" resizable="false" closable="true"
              visible="false" width="1200"
              header="Detalhes do Atendimento" appendTo="@(body)"
              showEffect="fade" hideEffect="fade"
              blockScroll="true" responsive="true"
              styleClass="border-round-xl overflow-hidden dlg-flex-fix">

        <h:form id="formVisualizar" prependId="false" styleClass="h-full flex flex-column w-full">

            <div class="surface-0 border-bottom-1 border-200 p-4 flex flex-column xl:flex-row justify-content-between align-items-start xl:align-items-center gap-4 flex-shrink-0">
                <div class="flex align-items-center">
                    <div class="#{empty supervisorBackofficeBean.atendimentoVisualizar.cliente ? 'bg-orange-50 text-orange-600' : 'bg-indigo-50 text-indigo-600'} border-circle w-4rem h-4rem flex align-items-center justify-content-center mr-3 shadow-1">
                        <i class="pi #{empty supervisorBackofficeBean.atendimentoVisualizar.cliente ? 'pi-user-secret' : 'pi-user'} text-2xl"></i>
                    </div>
                    <div>
                        <div class="flex align-items-center gap-2 mb-1">
                            <span class="text-2xl font-bold text-900">
                                #{empty supervisorBackofficeBean.atendimentoVisualizar.cliente ? 'Cliente Não Identificado' : supervisorBackofficeBean.atendimentoVisualizar.cliente.nome}
                            </span>
                            <p:tag value="#{supervisorBackofficeBean.atendimentoVisualizar.status.descricao}"
                                   styleClass="#{supervisorBackofficeBean.atendimentoVisualizar.status.acao.styleClass}"
                                   rounded="true"/>
                        </div>
                        <div class="flex align-items-center text-600 gap-3 text-sm flex-wrap">
                            <h:panelGroup
                                    rendered="#{not empty supervisorBackofficeBean.atendimentoVisualizar.cliente}">
                                <span class="flex align-items-center"><i
                                        class="pi pi-id-card mr-1"></i>#{supervisorBackofficeBean.atendimentoVisualizar.cliente.cpf}</span>
                                <span class="text-300">|</span>
                            </h:panelGroup>
                            <span class="flex align-items-center font-bold text-900"><i
                                    class="pi pi-hashtag mr-1 text-primary"></i>#{supervisorBackofficeBean.atendimentoVisualizar.protocolo}</span>
                            <span class="text-300">|</span>
                            <span class="flex align-items-center"><i
                                    class="pi pi-megaphone mr-1"></i>#{supervisorBackofficeBean.atendimentoVisualizar.campanha.descricao}</span>
                            <h:panelGroup
                                    rendered="#{not empty supervisorBackofficeBean.atendimentoVisualizar.cliente.idade}">
                                <span class="text-300">|</span>
                                <span class="flex align-items-center"><i
                                        class="pi pi-calendar mr-1"></i>#{supervisorBackofficeBean.atendimentoVisualizar.cliente.dataNascimentoFormatado}</span>
                            </h:panelGroup>
                            <h:panelGroup
                                    rendered="#{not empty supervisorBackofficeBean.atendimentoVisualizar.cliente}">

                                <span class="text-300">|</span>

                                <span class="flex align-items-center">

                                           <span class="text-800 mr-2"> Nome da mãe:</span> #{supervisorBackofficeBean.atendimentoVisualizar.cliente.nomeMae}

                                            </span>

                                <span class="text-300">|</span>

                                <span class="flex align-items-center">

                                          <span class="text-800 mr-2"> Nome do pai:</span>  #{supervisorBackofficeBean.atendimentoVisualizar.cliente.nomePai}

                                            </span>

                            </h:panelGroup>


                        </div>
                    </div>
                </div>

                <div class="flex flex-wrap gap-2 justify-content-end">
                    <h:panelGroup
                            rendered="#{supervisorBackofficeBean.formularioQuestionarioController.idQuestionario ne null}">
                        <p:commandButton icon="pi pi-list" title="Respostas"
                                         styleClass="ui-button-outlined ui-button-secondary rounded-button"
                                         update="dlgFormulario:formFormulario" oncomplete="PF('dlgFormulario').show();"
                                         actionListener="#{supervisorBackofficeBean.formularioQuestionarioController.selecionarFormulario(supervisorBackofficeBean.atendimentoVisualizar)}"/>
                        <p:commandButton icon="pi pi-volume-up" title="Áudios"
                                         styleClass="ui-button-outlined ui-button-secondary rounded-button"
                                         update="dlgFormulario:formFormulario" oncomplete="PF('dlgFormulario').show();"
                                         actionListener="#{supervisorBackofficeBean.formularioQuestionarioController.selecionarFormulario(supervisorBackofficeBean.atendimentoVisualizar)}"/>
                    </h:panelGroup>
                    <p:commandButton icon="pi pi-calculator" title="Calculadora"
                                     rendered="#{supervisorBackofficeBean.integracaoAmbec ne null}"
                                     update="dlgAtnCalculadora"
                                     styleClass="ui-button-outlined ui-button-info rounded-button"
                                     actionListener="#{supervisorBackofficeBean.consultarCalculadoraConsignado()}"/>

                    <div class="border-left-1 border-300 mx-1"></div>
                    <p:commandButton value="Novo" icon="pi pi-plus" disabled="true"
                                     styleClass="ui-button-success font-bold border-round-md shadow-none"
                                     oncomplete="PF('dlgVisualizarAtendimento').hide()">
                        <p:confirm header="Confirmar" message="Deseja gerar um novo Atendimento?"
                                   icon="pi pi-exclamation-triangle"/>
                    </p:commandButton>
                    <p:commandButton value="Fechar" icon="pi pi-times" onclick="PF('dlgVisualizarAtendimento').hide();"
                                     process="@this" global="false"
                                     styleClass="ui-button-secondary ui-button-outlined border-round-md font-bold"/>
                </div>
            </div>

            <div class="grid m-0 flex-grow-1 min-h-0 overflow-hidden" style="background-color: #f8fafc;">
                <div class="col-12 lg:col-8 p-4 h-full overflow-y-auto custom-scroll">
                    <div class="surface-card border-round-xl shadow-1 p-0 overflow-hidden mb-4">
                        <p:tabView id="tabviewVisualizarAtn" styleClass="border-none clean-tabs">
                            <p:tab title="Ficha Técnica">
                                <div class="p-4">

                                    <div class="surface-50 border-1 border-200 border-round-sm p-3 mb-4 grid grid-nogutter">

                                        <div class="col-12 md:col-8 mb-2 md:mb-0">
                <span class="text-500 text-xs font-bold uppercase block mb-1">
                    <i class="pi pi-tag mr-1"></i>Classificação
                </span>
                                            <div class="flex align-items-center text-900 font-medium">
                                                #{supervisorBackofficeBean.atendimentoVisualizar.motivo.descricao}
                                                <i class="pi pi-angle-right text-400 mx-2 text-sm"></i>
                                                #{supervisorBackofficeBean.atendimentoVisualizar.subMotivo.descricao}
                                            </div>
                                        </div>

                                        <div class="col-12 md:col-4 border-top-1 md:border-top-none md:border-left-1 border-300 pt-2 md:pt-0 md:pl-3">
                                               <span class="text-500 text-xs font-bold uppercase block mb-1">
                                                        <i class="pi pi-user mr-1"></i>Operador (Nível 1)
                                                    </span>
                                                                                <div class="flex align-items-center gap-2">
                                                                                    <p:avatar icon="pi pi-user" shape="circle" styleClass="bg-gray-200 text-gray-600 w-2rem h-2rem"/>
                                                                                    <span class="text-900 font-bold">
                                                            #{supervisorBackofficeBean.atendimentoVisualizar.usuarioCadastro.nome}
                                                        </span>
                                                                                </div>
                                        </div>
                                    </div>

                                    <h:panelGroup rendered="#{supervisorBackofficeBean.atendimentoVisualizar.enviarN2}" layout="block" styleClass="mb-4">

                                        <div class="bg-blue-50 border-round-xl p-4 border-1 border-blue-200 relative overflow-hidden">


                                            <div class="flex align-items-center justify-content-between mb-4 pl-3">
                                                <div class="flex align-items-center">
                                                    <div class="bg-blue-100 text-blue-600 border-circle w-2rem h-2rem flex align-items-center justify-content-center mr-2">
                                                        <i class="pi pi-directions"></i>
                                                    </div>
                                                    <span class="text-blue-900 font-bold text-lg">Tratativa Nível 2</span>
                                                </div>
                                                <div class="flex align-items-center bg-white border-1 border-blue-200 px-3 py-1 border-round-2xl shadow-sm">
                                                    <i class="pi pi-calendar-times text-orange-500 mr-2"></i>
                                                    <span class="text-sm text-700">Prazo: <b>#{supervisorBackofficeBean.atendimentoVisualizar.dataPrazoDemandaFormatada}</b></span>
                                                </div>
                                            </div>

                                            <div class="pl-3 mb-2">
                                                <span class="text-xs font-bold text-blue-600 uppercase mb-2 block ml-1">Relato do Envio (Solicitação N1)</span>
                                                <div class="surface-0 p-3 border-round-lg shadow-sm border-1 border-blue-100 text-700 line-height-3 relative">
                                                    <div class="absolute w-1rem h-1rem surface-0 border-left-1 border-top-1 border-blue-100"
                                                         style="top: -8px; left: 20px; transform: rotate(45deg);"></div>

                                                    <div style="white-space: pre-wrap; word-break: break-word;">
                                                        <h:outputText value="#{supervisorBackofficeBean.atendimentoVisualizar.observacao}"
                                                                      rendered="#{not empty supervisorBackofficeBean.atendimentoVisualizar.observacao}"/>
                                                        <h:outputText value="Sem observação de envio."
                                                                      rendered="#{empty supervisorBackofficeBean.atendimentoVisualizar.observacao}"
                                                                      styleClass="font-italic text-400"/>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="flex justify-content-center my-2">
                                                <i class="pi pi-arrow-down text-blue-300"></i>
                                            </div>

                                            <div class="pl-3">
                                                <span class="text-xs font-bold text-green-600 uppercase mb-2 block ml-1">Devolutiva / Solução (N2)</span>
                                                <div class="surface-0 p-3 border-round-lg shadow-sm border-left-3 border-green-500 text-900 line-height-3"
                                                     style="white-space: pre-wrap; word-break: break-word;">
                                                    <h:outputText value="#{supervisorBackofficeBean.atendimentoVisualizar.respostaN2}" escape="false"/>
                                                </div>

                                                <div class="flex justify-content-end mt-2 align-items-center gap-1">
                                                    <span class="text-xs text-blue-400">Resolvido por:</span>
                                                    <p:chip label="#{supervisorBackofficeBean.atendimentoVisualizar.responsavelN2.nome}"
                                                            icon="pi pi-check-circle" styleClass="bg-blue-100 text-blue-800 text-xs font-bold"/>
                                                </div>
                                            </div>
                                        </div>
                                    </h:panelGroup>

                                    <h:panelGroup rendered="#{not supervisorBackofficeBean.atendimentoVisualizar.enviarN2}">
                                        <div class="surface-card border-1 border-200 border-round-xl p-4 shadow-1 mb-4">
                                            <div class="flex align-items-center mb-3 border-bottom-1 border-100 pb-2">
                                                <i class="pi pi-align-left text-primary mr-2"></i>
                                                <span class="font-bold text-900">Relato do Atendimento</span>
                                            </div>

                                            <div class="text-900 line-height-3 text-lg"
                                                 style="white-space: pre-wrap; word-break: break-word;">
                                                <h:outputText value="#{supervisorBackofficeBean.atendimentoVisualizar.observacao}"
                                                              rendered="#{not empty supervisorBackofficeBean.atendimentoVisualizar.observacao}"/>
                                                <h:outputText value="Nenhuma observação registrada."
                                                              rendered="#{empty supervisorBackofficeBean.atendimentoVisualizar.observacao}"
                                                              styleClass="text-500 font-italic"/>
                                            </div>

                                            <h:panelGroup rendered="#{not empty supervisorBackofficeBean.atendimentoVisualizar.observacaoAdicional}">
                                                <div class="mt-4 bg-gray-50 p-3 border-round border-1 border-200">
                                                    <span class="text-xs font-bold text-500 uppercase block mb-2">Detalhes / Adicionais</span>
                                                    <div class="text-700" style="word-break: break-word;">
                                                        #{supervisorBackofficeBean.atendimentoVisualizar.observacaoAdicional}
                                                    </div>
                                                </div>
                                            </h:panelGroup>
                                        </div>
                                    </h:panelGroup>

                                    <p:divider align="center" styleClass="my-5">
                                        <span class="text-500 font-normal text-sm px-2">Dados Específicos</span>
                                    </p:divider>

                                    <div>
                                        <c:if test="#{supervisorBackofficeBean.atendimentoVisualizar.campanha.segmento eq 'EMPRESTIMO' or supervisorBackofficeBean.atendimentoVisualizar.campanha.segmento eq 'ASSOCIACAO' or supervisorBackofficeBean.atendimentoVisualizar.campanha.segmento eq 'PORTABILIDADE'}">
                                            <cc:emprestimo id="seqAtn"
                                                           atendimento="#{supervisorBackofficeBean.atendimentoVisualizar}"
                                                           managedBean="#{supervisorBackofficeBean}" ver="true"
                                                           viewAtendimento="false"/>
                                        </c:if>

                                        <c:if test="#{supervisorBackofficeBean.atendimentoVisualizar.campanha.segmento eq 'AGENDAMENTOS'}">
                                            <cc:agendamento
                                                    atendimento="#{supervisorBackofficeBean.atendimentoVisualizar}"
                                                    managedBean="#{supervisorBackofficeBean}" id="segAgendamento"
                                                    ver="true" viewAtendimento="false"/>
                                        </c:if>
                                    </div>

                                </div>
                            </p:tab>

                            <p:tab title="Dados Cadastrais">

                                <div class="p-0">

                                    <h:panelGroup  rendered="#{empty supervisorBackofficeBean.atendimentoVisualizar.cliente}"
                                            layout="block" styleClass="p-5 text-center">
                                        <div class="bg-orange-50 border-circle w-5rem h-5rem flex align-items-center justify-content-center mx-auto mb-3">
                                            <i class="pi pi-user-slash text-orange-400 text-3xl"></i></div>
                                        <span class="text-900 font-bold block mb-1">Atendimento sem Cadastro</span>

                                    </h:panelGroup>

                                    <h:panelGroup
                                            rendered="#{not empty supervisorBackofficeBean.atendimentoVisualizar.cliente}">

                                        <div class="p-3 border-bottom-1 border-100 bg-gray-50">
                                            <span class="font-bold text-900">

                                            <i class="pi pi-phone mr-2 text-indigo-500">
                                            </i>Telefones</span>
                                        </div>

                                        <p:dataTable value="#{supervisorBackofficeBean.atendimentoVisualizar.cliente.listaTelefonesOrdenada}"
                                                var="tel" styleClass="ui-datatable-borderless" rows="2"
                                                rowStyleClass="border-bottom-1 border-100">

                                            <p:column headerText="Número"><span
                                                    class="font-medium text-lg text-900">(#{tel.ddd}) #{tel.numero}</span></p:column>

                                            <p:column headerText="Status" width="100" styleClass="text-right">
                                                <i class="pi pi-circle-fill text-xs #{tel.statusTelefone.descricao eq 'Ativo' ? 'text-green-500' : 'text-red-500'} mr-1"></i>
                                                <span class="text-sm">#{tel.statusTelefone.descricao}</span>
                                            </p:column>

                                        </p:dataTable>

                                        <div class="p-3 border-bottom-1 border-100 bg-gray-50 border-top-1"><span
                                                class="font-bold text-900"><i
                                                class="pi pi-map-marker mr-2 text-indigo-500">

                                                 </i>Endereços</span>
                                        </div>

                                        <p:dataTable
                                                value="#{supervisorBackofficeBean.atendimentoVisualizar.cliente.listEnderecos}"
                                                var="endereco"
                                                rows="2"
                                                styleClass="ui-datatable-borderless text-sm"
                                                rowStyleClass="border-bottom-1 border-100">

                                            <p:column headerText="Endereço">
                                                <div class="flex flex-column"><span
                                                        class="font-bold text-900">#{endereco.logradouro}, #{endereco.numero}</span><span
                                                        class="text-500">#{endereco.bairro} - #{endereco.cep}</span>
                                                </div>
                                            </p:column>
                                            <p:column headerText="Cidade"
                                                      width="150">#{endereco.cidade} / #{endereco.uf}</p:column>

                                        </p:dataTable>
                                        <div class="p-3 border-bottom-1 border-100 bg-gray-50 border-top-1"><span
                                                class="font-bold text-900"><i
                                                class="pi pi-wallet mr-2 text-indigo-500"></i>Dados Bancários</span>
                                        </div>
                                        <p:dataTable
                                                value="#{supervisorBackofficeBean.atendimentoVisualizar.cliente.listDadosBancarios}"
                                                var="banco" styleClass="ui-datatable-borderless text-sm"
                                                rowStyleClass="border-bottom-1 border-100">
                                            <p:column headerText="Banco">#{banco.banco.constante}</p:column>
                                            <p:column headerText="Tipo">#{banco.tipoConta.descricao}</p:column>
                                            <p:column headerText="Conta">Ag: <b>#{banco.agencia}</b> / Cc:
                                            <b>#{banco.conta}</b>
                                            </p:column>
                                        </p:dataTable>
                                    </h:panelGroup>
                                </div>
                            </p:tab>

                            <p:tab title="Informações Complementares"
                                   rendered="#{not empty supervisorBackofficeBean.atendimentoVisualizar.listInformacoesComplementares}">
                                <div class="p-3">
                                    <div class="grid">
                                        <ui:repeat var="chave"
                                                   value="#{supervisorBackofficeBean.atendimentoVisualizar.listInformacoesComplementaresChaves}">
                                            <div class="col-12 md:col-4 mb-2">
                                                <div class="surface-50 border-round p-3 h-full border-1 border-200">
                                                    <span class="block text-500 font-bold text-xs uppercase mb-1">#{chave}</span>
                                                    <span class="text-900 font-medium text-sm"
                                                          style="word-break: break-word;">#{supervisorBackofficeBean.atendimentoVisualizar.listInformacoesComplementares[chave]}</span>
                                                </div>
                                            </div>
                                        </ui:repeat>
                                    </div>
                                </div>
                            </p:tab>

                            <p:tab id="tabHistorico" title="Histórico Global">
                                <div class="p-3">
                                    <div class="flex align-items-end mb-3">
                                        <p:commandButton value="Carregar Completo" icon="pi pi-refresh"
                                                         styleClass="ui-button-outlined ui-button-primary"
                                                         actionListener="#{supervisorBackofficeBean.buscarHistoricosAtendimentos()}"
                                                         update="tableHistoricoGlobal" process="@this"/>
                                    </div>
                                    <p:dataTable id="tableHistoricoGlobal" lazy="false"
                                                 value="#{supervisorBackofficeBean.listHistoricosAtendimentos}"
                                                 var="histGlobal" rows="8" paginator="true" paginatorPosition="bottom"
                                                 styleClass="ui-datatable-sm" stripedRows="true" showGridlines="false"
                                                 emptyMessage="Nenhum histórico carregado.">
                                        <p:column headerText="Campanha">#{histGlobal[0]}</p:column>
                                        <p:column headerText="ID">#{histGlobal[1]}</p:column>
                                        <p:column headerText="Operador">#{histGlobal[2]}</p:column>
                                        <p:column headerText="Status"><p:tag value="#{histGlobal[3]}" severity="info"/></p:column>
                                        <p:column headerText="Data"><h:outputText
                                                value="#{histGlobal[4]}"><f:convertDateTime pattern="dd/MM/yyyy HH:mm"/></h:outputText></p:column>
                                    </p:dataTable>
                                </div>
                            </p:tab>

                            <p:tab title="Logs">
                                <div class="p-0">
                                    <p:dataTable
                                            value="#{supervisorBackofficeBean.atendimentoVisualizar.listHistoricoAtividades}"
                                            var="at" rows="5" paginator="true" paginatorPosition="bottom"
                                            styleClass="ui-datatable-sm ui-datatable-borderless" stripedRows="true">
                                        <p:column headerText="Data" width="130"><span
                                                class="text-sm font-medium"><h:outputText
                                                value="#{at.data}"><f:convertDateTime
                                                pattern="dd/MM/yyyy HH:mm"/></h:outputText></span></p:column>
                                        <p:column headerText="Usuário">#{at.usuario.nome}</p:column>
                                        <p:column headerText="Evento"><span
                                                class="text-sm">#{at.tipoStatusAtividade.descricao}</span></p:column>
                                    </p:dataTable>
                                </div>
                            </p:tab>
                        </p:tabView>
                    </div>
                </div>

                <div class="col-12 lg:col-4 p-4 pl-0 h-full overflow-y-auto custom-scroll">
                    <div class="surface-card border-round-xl shadow-1 h-full flex flex-column">
                        <div class="p-3 border-bottom-1 border-100 flex align-items-center bg-gray-50 border-round-top-xl flex-shrink-0">
                            <i class="pi pi-history text-gray-500 mr-2"></i><span
                                class="font-bold text-700">Linha do Tempo</span>
                        </div>
                        <div class="flex-grow-1 p-3">

                            <ui:repeat value="#{supervisorBackofficeBean.atendimentoVisualizar.listaHistoricos}"
                                       var="hist" varStatus="status">
                                <div class="flex mb-0 relative">

                                    <div class="flex flex-column align-items-center mr-3" style="min-width: 20px;">
                                        <div class="w-1rem h-1rem border-circle #{not empty hist.respostaN2 ? 'bg-green-100 border-green-500' : 'bg-indigo-100 border-indigo-500'} border-2 z-1 flex-shrink-0"></div>

                                        <h:panelGroup rendered="#{!status.last}"
                                                      styleClass="w-2px bg-gray-300 flex-grow-1 -mt-1" layout="block"
                                                      style="min-height: 2rem;"/>
                                    </div>

                                    <div class="pb-4 w-full">

                                        <div class="flex justify-content-between align-items-baseline mb-1">
                                            <span class="font-bold text-900 text-sm">#{hist.statusAtendimento.descricao}</span>
                                            <span class="text-xs text-500 bg-gray-100 px-2 border-round">
                    <h:outputText value="#{hist.dataCadastro}">
                        <f:convertDateTime pattern="dd/MM HH:mm"/>
                    </h:outputText>
                </span>
                                        </div>

                                        <div class="text-xs text-500 flex align-items-center mb-2">
                                            <i class="pi pi-user mr-1 text-xs"></i> #{hist.usuario.nome}
                                        </div>

                                        <h:panelGroup rendered="#{not empty hist.observacao}">
                                            <div class="surface-100 p-2 border-round text-xs text-600 font-italic line-height-3 border-1 border-100 relative mb-1"
                                                 style="word-break: break-word;">
                                                "#{of:abbreviate(hist.observacao, 100)}"
                                            </div>
                                        </h:panelGroup>

                                        <h:panelGroup rendered="#{not empty hist.respostaN2}">
                                            <div class="bg-green-50 p-2 border-round text-xs text-green-900 font-italic line-height-3 border-1 border-green-200 relative mt-1"
                                                 style="word-break: break-word;">
                                                <i class="pi pi-reply mr-1 text-green-600" style="transform: rotate(180deg)"></i>
                                                <span class="font-bold text-green-700 mr-1">N2:</span>
                                                "#{of:abbreviate(hist.respostaN2, 100)}"
                                            </div>
                                        </h:panelGroup>

                                    </div>

                                </div>

                            </ui:repeat>

                        </div>
                    </div>
                </div>
            </div>

            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" responsive="true" width="350">
                <p:commandButton value="Sim" styleClass="ui-confirmdialog-yes ui-button-primary" type="button"/>
                <p:commandButton value="Não" styleClass="ui-confirmdialog-no ui-button-outlined" type="button"/>
            </p:confirmDialog>

        </h:form>
    </p:dialog>
</ui:fragment>