<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:o="http://omnifaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:matriz="http://java.sun.com/jsf/composite/componentes"
	xmlns:p="http://primefaces.org/ui">

	<h:form id="formBackofficeNaoTrabalhado" prependId="false">

		<div class="grid col-12 mt-3">

			<matriz:selectEmpresa id="selectEmpresaNaoTrabalhado"	managedBean="#{acompanhamentoConsistencias}" value="#{acompanhamentoConsistencias.empresa}" ajax="true" update="@form" filter="true" exibirSelecione="true"
								  required="true" style="col-12 md:col-3" />

			
			<div class="field col-12 md:col-3">

				<p:outputLabel value="Loja" />

				<p:selectOneMenu id="selecLojaNaoTrabalhada"	value="#{acompanhamentoConsistencias.lojaNaoTrabalhada}"  filter="true" filterMatchMode="contains" autoWidth="false">

					<f:selectItem itemLabel="Selecione" itemValue="" />

					<f:selectItems value="#{acompanhamentoConsistencias.listLojas}"	var="loja" itemLabel="#{loja.codigoLoja}" itemValue="#{loja.id}" />

				</p:selectOneMenu>

			</div>

			<div class="field col-12 md:col-3">

				<p:outputLabel value="Consistencias" />

				<p:selectOneMenu id="selectConsistenciasNaoTrabalhada"	value="#{acompanhamentoConsistencias.consistenciaNaoTrabalhada}"  filter="true" filterMatchMode="contains" autoWidth="false">

					<f:selectItem itemLabel="Selecione" itemValue="" />

					<f:selectItems value="#{acompanhamentoConsistencias.listConsistencias}"	var="consistencia" itemLabel="#{consistencia.codigoConcistencia}" itemValue="#{consistencia.id}" />

				</p:selectOneMenu>

			</div>

			<div class="field col-12 md:col-3">

				<p:outputLabel value="CPF" />

				<p:inputText id="txtCpfNaoTrabalhado" value="#{acompanhamentoConsistencias.cpfNaoTrabalhado}" />

			</div>


			<div class="field col-12 md:col-3">

				<p:outputLabel value="Adesão" />

				<p:inputText id="txtAdesaoNaoTrabalhado" value="#{acompanhamentoConsistencias.adesaoNaoTrabalhada}" />

			</div>


			<div class="field col-12 mt-3">

				<p:outputLabel value="&#160;&#160;"  />

				<div>
				
					<p:commandButton value="Pesquisar" id="btnPesquisarNaoTrabalhado" icon="pi pi-search" styleClass="ui-button-raised mr-3" actionListener="#{acompanhamentoConsistencias.pesquisarAtendimentosNaoTrabalhados()}" update="@form" />
				
					<p:commandButton id="btnExportarNaoTrabalhado" styleClass="mr-3 ui-button-raised ui-button-outlined" icon="pi pi-file-excel" value="#{msg.exportar}" 	ajax="false" onclick="disableModalLoading()"
												rendered="#{sessionScope['usuario'].permissaoExportar}"
												disabled="#{empty acompanhamentoConsistencias.listNaoTrabalhados}">
		
									<p:dataExporter target="tableAtendimentosNaoTrabalhados" type="xls"	fileName="atendimentos_nao_trabalhados" />
		
								</p:commandButton>
		
				</div>

			</div>
		
		
		<div class="col-12p-mt-3">

			<p:dataTable id="tableAtendimentosNaoTrabalhados"  var="atendimento" rows="15"	paginator="true" paginatorPosition="bottom"	value="#{acompanhamentoConsistencias.listNaoTrabalhados}"
					rowKey="#{atendimento[0]}" emptyMessage="#{acompanhamentoConsistencias.listNaoTrabalhados eq null? '' : msg.emptyMessage}"	currentPageReportTemplate="[#{msg.totalDeRegistros}: {totalRecords}]"
					
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}" styleClass="ui-datatable-sm ui-datatable-striped ui-datatable-gridlines">

					<p:ajax event="page"  />

					<p:ajax event="sort" global="false" />
					

					<p:column headerText="Data cadastro" sortBy="#{atendimento[8]}" width="10%">

						<h:outputLabel value="#{atendimento[8]}">

							<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />

						</h:outputLabel>

					</p:column>

					<p:column headerText="Cliente" sortBy="#{atendimento[1]}"	width="12%">

						<h:outputLabel value="#{atendimento[1]}" />

					</p:column>

					<p:column headerText="CPF" sortBy="#{atendimento[2]}" width="7%">

						<h:outputLabel value="#{atendimento[2]}" />

					</p:column>

					<p:column headerText="Adesão" sortBy="#{atendimento[3]}" width="10%">

						<h:outputLabel value="#{atendimento[3]}" />

					</p:column>
					
					
					<p:column headerText="Status import" sortBy="#{atendimento[5]}" width="15%">

						<h:outputLabel value="#{atendimento[5]}" />

					</p:column>

			

				<p:column headerText="Serviço" sortBy="#{atendimento[4]}" width="15%">

						<h:outputLabel value="#{atendimento[4]}" />

					</p:column> 

					<p:column headerText="Consistências" sortBy="#{atendimento[6]}" width="10%">

						<h:outputLabel value="#{atendimento[6]}" />

					</p:column>


					<p:column headerText="Loja" sortBy="#{atendimento[9]}" width="5%">

						<h:outputLabel value="#{atendimento[9]}" />

					</p:column>

			<!-- 		<p:column headerText="Valor Liberado" sortBy="#{atendimento[7]}"	width="5%">

						<h:outputLabel value="#{atendimento[7]}" >
							<f:convertNumber type="currency" locale="pt-br" currencySymbol="R$"/>
						</h:outputLabel>

					</p:column> -->

					<p:column width="5%" exportable="false">
						
						
						<p:commandButton icon="pi pi-chevron-circle-right"	styleClass="rounded-button ui-button-flat"	oncomplete="PF('dlgConfirmarAntecipacaoAtendimentoNaoTrabalhado').show();"	 global="false" id="btnAdiantarAtn" title="Trabalhar Atendimento">

							<f:setPropertyActionListener value="#{atendimento[0]}"	target="#{acompanhamentoConsistencias.idAtendimento}" />

						</p:commandButton>
						
					<p:commandButton styleClass="rounded-button ui-button-flat" icon="fa fa-list-alt" onclick="PF('dlgVisualizarAtendimento').show()" update=":formVisualizar" title="Visualizar" immediate="true" action="#{acompanhamentoConsistencias.visualizarAtendimento(atendimento[0])}"/>
					 
				</p:column>

						
				</p:dataTable>
				
					<p:confirmDialog id="dlgConfirmarAntecipacaoAtendimentoNaoTrabalhado" widgetVar="dlgConfirmarAntecipacaoAtendimentoNaoTrabalhado" message="Iniciar Atendimento?" header="Confirmar" appendTo="@(body)" >

									<p:commandButton id="btnConfirmarAtn" update="tableAtendimentosNaoTrabalhados"  value="Sim" icon="pi pi-check" action="#{acompanhamentoConsistencias.adiantarFichaAtendimentoNaoTrabalado()}" oncomplete="PF('dlgConfirmarAntecipacaoAtendimentoNaoTrabalhado').hide();" immediate="true">

									</p:commandButton>

									<p:commandButton type="button" icon="pi pi-times"	onclick="PF('dlgConfirmarAntecipacaoAtendimentoNaoTrabalhado').hide();" value="Não" />

								</p:confirmDialog>

			</div>
		
		</div>

	</h:form>

</ui:fragment>