<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="viewname">
        <div class="bcca-breadcrumb">
            <div class="bcca-breadcrumb-item bg-primary-500 hover:bg-primary-700">
                <p:link outcome="/pages/backoffice/acompanhamentoConsistencias"
                        style="text-decoration: none" styleClass="text-white font-medium">PAINEL BACKOFFICE</p:link>
            </div>
            <div class="bcca-breadcrumb-item uppercase font-bold">DASHBOARD</div>
        </div>
    </ui:define>

    <ui:define name="content">

        <p:growl id="grl" globalOnly="true" showDetail="true" life="5000">
            <p:autoUpdate/>
        </p:growl>

        <h:form id="formDashboard" prependId="false">

            <div class="surface-ground px-4 py-6 md:px-6 lg:px-8">

                <div class="flex flex-column md:flex-row md:align-items-center justify-content-end mb-5 gap-3">
                    <div class="flex align-items-center gap-2 surface-card p-2 border-round shadow-1">
                        <i class="pi pi-calendar text-blue-500 text-lg ml-2"></i>
                        <span class="font-medium text-600 white-space-nowrap">Período:</span>
                        <p:selectOneMenu id="selectPeriodo" value="#{monitorBackofficeBean.periodo}"
                                         autoWidth="false" styleClass="w-full md:w-12rem border-none shadow-none">
                            <f:selectItem itemLabel="Diário" itemValue="DIA"/>
                            <f:selectItem itemLabel="Semanal" itemValue="SEMANA"/>
                            <f:selectItem itemLabel="Mensal" itemValue="MES"/>
                            <f:selectItem itemLabel="Personalizado" itemValue="CUSTOM"/>
                            <p:ajax listener="#{monitorBackofficeBean.onAtualizarPanel}" update="@form"/>
                        </p:selectOneMenu>
                    </div>

                    <h:panelGroup id="pnlDatasCustom">
                        <h:panelGroup rendered="#{monitorBackofficeBean.periodo eq 'CUSTOM'}"
                                      styleClass="flex align-items-center gap-2 fadein animation-duration-300 surface-card p-2 border-round shadow-1">
                            <p:datePicker value="#{monitorBackofficeBean.dataInicioPanel}" showIcon="false"
                                          placeholder="Início" pattern="dd/MM/yyyy"
                                          inputStyleClass="w-7rem text-center border-none shadow-none text-sm font-bold text-blue-600">
                                <p:ajax event="dateSelect" listener="#{monitorBackofficeBean.onAtualizarPanel}" update="@form"/>
                            </p:datePicker>
                            <span class="text-400 pi pi-arrow-right text-xs"></span>
                            <p:datePicker value="#{monitorBackofficeBean.dataFimPanel}" showIcon="false"
                                          placeholder="Fim" pattern="dd/MM/yyyy"
                                          inputStyleClass="w-7rem text-center border-none shadow-none text-sm font-bold text-blue-600">
                                <p:ajax event="dateSelect" listener="#{monitorBackofficeBean.onAtualizarPanel}" update="@form"/>
                            </p:datePicker>
                        </h:panelGroup>
                    </h:panelGroup>
                </div>

                <div class="grid mb-4">
                    <div class="col-12 md:col-6 lg:col">
                        <div class="surface-card shadow-1 p-3 border-round-xl h-full flex align-items-center justify-content-between hover:surface-50 transition-duration-200">
                            <div>
                                <span class="block text-500 font-medium text-sm mb-1">Clientes</span>
                                <div class="text-900 font-bold text-2xl">#{monitorBackofficeBean.totalCpf}</div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-blue-50 border-circle w-3rem h-3rem">
                                <i class="pi pi-users text-blue-500 text-xl"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 md:col-6 lg:col">
                        <div class="surface-card shadow-1 p-3 border-round-xl h-full flex align-items-center justify-content-between hover:surface-50 transition-duration-200">
                            <div>
                                <span class="block text-500 font-medium text-sm mb-1">Atendimentos</span>
                                <div class="text-900 font-bold text-2xl">#{monitorBackofficeBean.totalAtendimento}</div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-indigo-50 border-circle w-3rem h-3rem">
                                <i class="pi pi-list text-indigo-500 text-xl"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 md:col-6 lg:col">
                        <div class="surface-card shadow-1 p-3 border-round-xl h-full flex align-items-center justify-content-between hover:surface-50 transition-duration-200">
                            <div>
                                <span class="block text-500 font-medium text-sm mb-1">No Prazo</span>
                                <div class="text-900 font-bold text-2xl">#{monitorBackofficeBean.totalPrazo}</div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-green-50 border-circle w-3rem h-3rem">
                                <i class="pi pi-clock text-green-500 text-xl"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 md:col-6 lg:col">
                        <div class="surface-card shadow-1 p-3 border-round-xl h-full flex align-items-center justify-content-between hover:surface-50 transition-duration-200">
                            <div>
                                <span class="block text-500 font-medium text-sm mb-1">Excedido</span>
                                <div class="text-pink-600 font-bold text-2xl">
                                    <h:outputText value="#{monitorBackofficeBean.totalPrazoExcedido}"/>
                                </div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-pink-50 border-circle w-3rem h-3rem">
                                <i class="pi pi-exclamation-circle text-pink-500 text-xl"/>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 md:col-6 lg:col">
                        <h:panelGroup id="cardConcluido" layout="block" styleClass="surface-card shadow-1 p-3 border-round-xl h-full flex align-items-center justify-content-between hover:surface-50 transition-duration-200 cursor-pointer">
                            <div>
                                <span class="block text-500 font-medium text-sm mb-1">Total Concluído</span>
                                <div class="text-teal-600 font-bold text-2xl">
                                    <h:outputText value="#{monitorBackofficeBean.totalFinalizado}"/>
                                </div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-teal-50 border-circle w-3rem h-3rem">
                                <i class="pi pi-check-circle text-teal-500 text-xl"/>
                            </div>
                        </h:panelGroup>

                        <p:tooltip for="cardConcluido" position="top" showEffect="fade" hideEffect="fade" styleClass="shadow-4">
                            <div class="p-2">
                                <div class="font-bold text-center mb-2 text-white border-bottom-1 border-white-alpha-20 pb-1">Detalhamento</div>

                                <div class="flex align-items-center justify-content-between gap-4 mb-2">
                                    <span class="text-white"><i class="pi pi-star mr-2 text-sm"></i>Resolvido N1:</span>
                                    <span class="font-bold text-teal-300 text-lg">#{monitorBackofficeBean.totalResolvidoN1}</span>
                                </div>

                                <div class="flex align-items-center justify-content-between gap-4">
                                    <span class="text-white"><i class="pi pi-shield mr-2 text-sm"></i>Resolvido N2:</span>
                                    <span class="font-bold text-yellow-300 text-lg">#{monitorBackofficeBean.totalResolvidoN2}</span>
                                </div>
                            </div>
                        </p:tooltip>
                    </div>

                    <div class="col-12 md:col-6 lg:col">
                        <div class="surface-card shadow-1 p-3 border-round-xl h-full flex align-items-center justify-content-between hover:surface-50 transition-duration-200"
                            >

                            <div>
                                <span class="block text-500 font-medium text-sm mb-1">Taxa FCR</span>

                                <div class="text-teal-600 font-bold text-2xl"  title="First Call Resolution (Resolução no Primeiro Contato)">
                                    <h:outputText value="#{monitorBackofficeBean.totalPercentFcr}">
                                        <f:convertNumber type="percent" minFractionDigits="1" maxFractionDigits="1" />
                                    </h:outputText>
                                </div>
                            </div>

                            <h:panelGroup id="carReicidencia" styleClass="text-orange-600 font-bold text-2xl" layout="block">
                                <span class="block text-500 font-medium text-sm mb-1">Reincidência</span>
                                <h:outputText value="#{monitorBackofficeBean.totalPercentReincidencia}">
                                    <f:convertNumber type="percent" minFractionDigits="1" />
                                </h:outputText>
                            </h:panelGroup>

                            <div class="flex align-items-center justify-content-center bg-teal-50 border-circle w-3rem h-3rem">
                                <i class="pi pi-thumbs-up text-teal-500 text-xl"/>
                            </div>

                        </div>
                    </div>
                </div>

                <p:tooltip for="carReicidencia" position="top" showEffect="fade" hideEffect="fade" styleClass="shadow-4">

                    <div class="p-2">
                        <div class="font-bold text-center mb-2 text-white border-bottom-1 border-white-alpha-20 pb-1">Total Reincidência</div>
                        <div class="flex align-items-center justify-content-between gap-4">
                            <span class="font-bold text-orange-300 text-lg">#{monitorBackofficeBean.totalReincidencia}</span>
                        </div>
                    </div>

                </p:tooltip>
                <div class="grid">

                    <div class="col-12 xl:col-4">
                        <div class="surface-card shadow-1 border-round-xl p-4 h-full flex flex-column">
                            <div class="flex align-items-center justify-content-between mb-3 border-bottom-1 border-100 pb-2">
                                <span class="text-900 font-bold text-lg">Status Atendimento</span>
                            </div>

                            <h:panelGroup rendered="#{not empty monitorBackofficeBean.listStatusPainel}">
                                <div class="flex align-items-center gap-2 h-full">
                                    <div class="w-5 flex align-items-center justify-content-center">
                                        <p:donutChart model="#{monitorBackofficeBean.donutModelStatusAtendimento}"
                                                      style="width: 100%; height: 140px;"/>
                                    </div>

                                    <div class="w-7">
                                        <p:dataTable value="#{monitorBackofficeBean.listStatusPainel}" var="status"
                                                     rows="4" paginator="false"
                                                     styleClass="ui-datatable-sm ui-datatable-borderless text-xs" reflow="true">

                                            <p:column width="15%">
                                                <span class="block border-circle w-1rem h-1rem shadow-1" style="background-color: #{status.cor};"></span>
                                            </p:column>

                                            <p:column headerText="Status">
                                                <span class="text-700 white-space-nowrap text-overflow-ellipsis overflow-hidden block" style="max-width: 85px;" title="#{status.visualizacao}">
                                                    #{status.visualizacao}
                                                </span>
                                            </p:column>

                                            <p:column headerText="Qtd" styleClass="font-bold text-right">
                                                #{status.qtdeAtendimento}
                                            </p:column>
                                        </p:dataTable>
                                    </div>
                                </div>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{empty monitorBackofficeBean.listStatusPainel}"
                                          styleClass="flex flex-column align-items-center justify-content-center flex-grow-1 text-center py-5">
                                <div class="bg-gray-50 border-circle w-4rem h-4rem flex align-items-center justify-content-center mb-2">
                                    <i class="pi pi-chart-pie text-gray-300 text-3xl"></i>
                                </div>
                                <span class="text-600 text-sm font-medium">Sem dados de Status</span>
                            </h:panelGroup>
                        </div>
                    </div>

                    <div class="col-12 xl:col-4">
                        <div class="surface-card shadow-1 border-round-xl p-4 h-full flex flex-column">
                            <div class="flex align-items-center justify-content-between mb-3 border-bottom-1 border-100 pb-2">
                                <span class="text-900 font-bold text-lg">Motivos</span>
                            </div>

                            <h:panelGroup rendered="#{not empty monitorBackofficeBean.listMotioPainel}">
                                <div class="flex align-items-center gap-2 h-full">
                                    <div class="w-5 flex align-items-center justify-content-center">
                                        <p:donutChart model="#{monitorBackofficeBean.donutModelMotivo}"
                                                      style="width: 100%; height: 140px;"/>
                                    </div>
                                    <div class="w-7">
                                        <p:dataTable value="#{monitorBackofficeBean.listMotioPainel}" var="motivo"
                                                     rows="4" paginator="false"
                                                     styleClass="ui-datatable-sm ui-datatable-borderless text-xs" reflow="true">

                                            <p:column width="15%">
                                                <span class="block border-circle w-1rem h-1rem shadow-1" style="background-color: #{motivo.cor};"></span>
                                            </p:column>

                                            <p:column headerText="Motivo">
                                                <span class="text-700 white-space-nowrap text-overflow-ellipsis overflow-hidden block" style="max-width: 85px;" title="#{motivo.visualizacao}">
                                                    #{motivo.visualizacao}
                                                </span>
                                            </p:column>

                                            <p:column headerText="Qtd" styleClass="font-bold text-right">
                                                #{motivo.qtdeAtendimento}
                                            </p:column>
                                        </p:dataTable>
                                    </div>
                                </div>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{empty monitorBackofficeBean.listMotioPainel}"
                                          styleClass="flex flex-column align-items-center justify-content-center flex-grow-1 text-center py-5">
                                <div class="bg-gray-50 border-circle w-4rem h-4rem flex align-items-center justify-content-center mb-2">
                                    <i class="pi pi-tag text-gray-300 text-3xl"></i>
                                </div>
                                <span class="text-600 text-sm font-medium">Sem dados de Motivos</span>
                            </h:panelGroup>
                        </div>
                    </div>

                    <div class="col-12 xl:col-4">
                        <div class="surface-card shadow-1 border-round-xl p-4 h-full flex flex-column">
                            <div class="flex align-items-center justify-content-between mb-3 border-bottom-1 border-100 pb-2">
                                <span class="text-900 font-bold text-lg">Submotivos</span>
                            </div>

                            <h:panelGroup rendered="#{not empty monitorBackofficeBean.listSubmotioPainel}">
                                <div class="flex align-items-center gap-2 h-full">
                                    <div class="w-5 flex align-items-center justify-content-center">
                                        <p:donutChart model="#{monitorBackofficeBean.donutSubmodelMotivo}"
                                                      style="width: 100%; height: 140px;"/>
                                    </div>
                                    <div class="w-7">
                                        <p:dataTable value="#{monitorBackofficeBean.listSubmotioPainel}" var="sub"
                                                     rows="4" paginator="false"
                                                     styleClass="ui-datatable-sm ui-datatable-borderless text-xs" reflow="true">

                                            <p:column width="15%">
                                                <span class="block border-circle w-1rem h-1rem shadow-1" style="background-color: #{sub.cor};"></span>
                                            </p:column>

                                            <p:column headerText="Submotivo">
                                                <span class="text-700 white-space-nowrap text-overflow-ellipsis overflow-hidden block" style="max-width: 85px;" title="#{sub.visualizacao}">
                                                    #{sub.visualizacao}
                                                </span>
                                            </p:column>

                                            <p:column headerText="Qtd" styleClass="font-bold text-right">
                                                #{sub.qtdeAtendimento}
                                            </p:column>
                                        </p:dataTable>
                                    </div>
                                </div>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{empty monitorBackofficeBean.listSubmotioPainel}"
                                          styleClass="flex flex-column align-items-center justify-content-center flex-grow-1 text-center py-5">
                                <div class="bg-gray-50 border-circle w-4rem h-4rem flex align-items-center justify-content-center mb-2">
                                    <i class="pi pi-tags text-gray-300 text-3xl"></i>
                                </div>
                                <span class="text-600 text-sm font-medium">Sem dados de Submotivos</span>
                            </h:panelGroup>
                        </div>
                    </div>
                </div>

                <h:panelGroup rendered="#{not empty monitorBackofficeBean.listTotal}">
                    <div class="grid mt-4">

                        <div class="col-12 lg:col-6">
                            <div class="surface-card shadow-1 border-round-xl p-4 h-full flex flex-column">
                             <span class="text-900 font-bold text-lg block mb-4 border-bottom-1 border-100 pb-2">
                                  Atendimentos Concluídos x Em Aberto
                             </span>

                                <div class="flex align-items-center justify-content-center flex-grow-1">
                                    <p:polarAreaChart model="#{monitorBackofficeBean.polarAreaModelConsistencia}"
                                                      style="width: 100%; height: 180px;"/>
                                </div>
                            </div>
                        </div>

                        <div class="col-12 lg:col-6">
                            <div class="surface-card shadow-1 border-round-xl p-4 h-full">
                            <span class="text-900 font-bold text-lg block mb-4 border-bottom-1 border-100 pb-2">
                                Detalhamento Geral
                            </span>

                                <p:dataTable value="#{monitorBackofficeBean.listTotal}" var="t"

                                             styleClass="ui-datatable-sm ui-datatable-striped" stripedRows="true" reflow="true"
                                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {NextPageLink} {LastPageLink}">

                                    <p:column headerText="Clientes" sortBy="#{t.qtdeCpf}" styleClass="text-center" width="80">
                                        <h:outputText value="#{t.qtdeCpf}"/>
                                    </p:column>

                                    <p:column headerText="Total" sortBy="#{t.qtdeAtendimento}" styleClass="text-center font-bold text-blue-600" width="80">
                                        #{t.qtdeAtendimento}
                                    </p:column>

                                    <p:column headerText="Res. N1" sortBy="#{t.qtdadeResolvidoN1}" styleClass="text-center" width="90">
                                        <div class="flex align-items-center justify-content-center gap-1">
                                            <i class="pi pi-star text-purple-500 text-xs"></i>
                                            <h:outputText value="#{t.qtdadeResolvidoN1}" styleClass="text-700"/>
                                        </div>
                                    </p:column>

                                    <p:column headerText="Res. N2" sortBy="#{t.qtdeResolvidoN2}" styleClass="text-center" width="90">
                                        <div class="flex align-items-center justify-content-center gap-1">
                                            <i class="pi pi-shield text-yellow-600 text-xs"></i>
                                            <h:outputText value="#{t.qtdeResolvidoN2}" styleClass="text-700"/>
                                        </div>
                                    </p:column>

                                    <p:column headerText="No Prazo" sortBy="#{t.qtdadeDemandaNoPrazo}" styleClass="text-center">
                                        <span class="inline-block border-round px-2 py-1 bg-green-100 text-green-700 text-sm font-bold">
                                            #{t.qtdadeDemandaNoPrazo}
                                        </span>
                                                    </p:column>

                                                    <p:column headerText="Excedido" sortBy="#{t.qtdadeDemandaPrazoEstourado}" styleClass="text-center">
                                        <span class="inline-block border-round px-2 py-1 bg-pink-100 text-pink-700 text-sm font-bold">
                                            #{t.qtdadeDemandaPrazoEstourado}
                                        </span>
                                    </p:column>

                                    <p:column headerText="Aberto" sortBy="#{t.qtidadeEmAberto}" styleClass="text-center">
                                        <h:outputText value="#{t.qtidadeEmAberto}" styleClass="text-500"/>
                                    </p:column>

                                    <p:column headerText="% FCR" sortBy="#{t.percentualFcr}" styleClass="text-center">
                                    <span class="inline-block border-round px-2 py-1 bg-teal-100 text-teal-800 text-sm font-bold shadow-1">
                                        <h:outputText value="#{t.percentualFcr}">
                                            <f:convertNumber type="percent" minFractionDigits="1" maxFractionDigits="1" />
                                        </h:outputText>
                                    </span>
                                    </p:column>

                                </p:dataTable>
                            </div>
                        </div>
                    </div>
                </h:panelGroup>

                <h:panelGroup rendered="#{empty monitorBackofficeBean.listTotal}" styleClass="block mt-4">
                    <div class="surface-card shadow-1 border-round-xl p-6 text-center">
                        <div class="bg-blue-50 border-circle w-6rem h-6rem flex align-items-center justify-content-center mx-auto mb-4">
                            <i class="pi pi-search text-blue-500 text-5xl"></i>
                        </div>
                        <span class="text-900 font-bold text-2xl block mb-2">Sem resultados</span>
                        <span class="text-600 text-lg">Não encontramos dados para o período selecionado.</span>
                    </div>
                </h:panelGroup>

            </div>
        </h:form>
    </ui:define>
</ui:composition>